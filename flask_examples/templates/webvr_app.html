<!DOCTYPE html>
<html>
  <head>
  	<meta charset="utf-8">

  	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">

  	<title>{{ title if title else "Primrose Demo" }}</title>


<!-- 
THREE.JS
########

ShaderParticles.js compatibility:
  lib/three.js: no ()
  lib/three-r71.min.js: yes, but doesn't support renderer.getSize for VREffect.js
 --> 
<!-- 
    <script src="{{ url_for('static', filename='lib/three.js') }}"></script>
 -->

    <script src="{{ url_for('static', filename='lib/three-r72dev.js') }}"></script>

<!-- 
    <script src="{{ url_for('static', filename='lib/three-r71.min.js') }}"></script>
 -->


<!--

STATS.JS
-->
    <script src="{{ url_for('static', filename='lib/stats.js') }}"></script>  
<!--
COLLADALOADER.JS
-->
<!-- 
    <script src="{{ url_for('static', filename='lib/ColladaLoader.js') }}"></script>
 -->
    <script src="{{ url_for('static', filename='lib/ColladaLoader-r72dev.js') }}"></script>

<!--
VREFFECT.JS
-->
    <script src="{{ url_for('static', filename='lib/VREffect.js') }}"></script>  


<!--
CANNON.js
#########

-->
    <script src="{{ url_for('static', filename='lib/cannon.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/cannon.demo.js') }}"></script>

<!--
LEAP.js
#######

-->
    <script src="{{ url_for('static', filename='lib/leap-0.6.4.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/socket.io.min.js') }}"></script>	


<!--
PRIMROSE.js
###########

-->
    <script src="{{ url_for('static', filename='dist/Primrose.js') }}"></script>
    <script src="{{ url_for('static', filename='src/VRApplication.js') }}"></script>
    <script src="{{ url_for('static', filename='src/helpers/graphics.js') }}"></script>
    <script src="{{ url_for('static', filename='src/helpers/fullscreen.js') }}"></script>
    <script src="{{ url_for('static', filename='src/text/controls/TextBox.js') }}"></script>
    <script src="{{ url_for('static', filename='src/text/grammars/Python.js') }}"></script>
    <script src="{{ url_for('static', filename='src/input/ButtonAndAxis.js') }}"></script>
    <script src="{{ url_for('static', filename='src/input/Gamepad.js') }}"></script>
    <script src="{{ url_for('static', filename='src/ModelLoader.js') }}"></script>


<!--
JQUERY.js
#########

-->
  	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  	<script>
  	window.jQuery ||
  	document.write('<script src="{{ url_for('static', filename='lib/jquery.js') }}">\x3C/script>')
  	</script>
    <script src="{{ url_for('static', filename='flask_examples/utilities/URLParams.js') }}"></script>


<!--
FONTS
-->
    <script src="{{ url_for('static', filename='lib/janda_manatee_solid_regular.typeface.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/droid_sans_regular.typeface.js') }}"></script>

<!--
APP DEPENDENCIES
-->
    {{ other_dependencies if other_dependencies else "" }}
    <script src="{{ url_for('static', filename='flask_examples/TextGeomLog.js') }}"></script>
    <script src="{{ url_for('static', filename='flask_examples/SkyBox.js') }}"></script>    
    <script src="{{ url_for('static', filename='lib/ImprovedNoise.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/water-material.js') }}"></script>
    <script src="{{ url_for('static', filename='lib/ShaderParticles.js') }}"></script>

<!--
APP
-->
    <script src="{{ url_for('static', filename='flask_examples/WebVRApplication.js') }}"></script>
    <script src="{{ url_for('static', filename='flask_examples/webvr_controls.js') }}"></script>
    <script src="{{ url_for('static', filename='flask_examples/webvr_physics.js') }}"></script>
    <script src="{{ url_for('static', filename='flask_examples/webvr_terrain.js') }}"></script>
    <script src="{{ url_for('static', filename='flask_examples/webvr_mouse.js') }}"></script>
    <script src="{{ url_for('static', filename='flask_examples/webvr_app.js') }}"></script>

    <link href="{{ url_for('static', filename='flask_examples/style.css') }}" type="text/css" rel="stylesheet">

  </head>

  <body onload="{{ onload if onload else 'StartDemo()' }}">

  {{ vertexshaders if vertexshaders else "" }}
  <script type="x-shader/x-vertex" id="vertexshader">

      attribute float size;
      attribute vec3 ca;

      varying vec3 vColor;

      void main() {

        vColor = ca;

        vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

        gl_PointSize = size;
        //gl_PointSize = size * ( 300.0 / length( mvPosition.xyz ) );

        gl_Position = projectionMatrix * mvPosition;

      }

    </script>

    {{ fragmentshaders if fragmentshaders else "" }}
    <script type="x-shader/x-fragment" id="fragmentshader">

      uniform vec3 color;
      uniform sampler2D texture;

      varying vec3 vColor;

      void main() {

        vec4 color = vec4( color * vColor, 1.0 ) * texture2D( texture, gl_PointCoord );

        if ( color.w < 0.5 ) discard;

        gl_FragColor = color;

      }

    </script>


    <div id="outputContainer">
      <canvas id="frontBuffer"></canvas>
    </div>

    <article id="main">

      <a class="primary button" id="goVR">
        <div id="fullScreenMsg">Go VR!</div>
        <small>hit ESC to exit.</small>
      </a>

      <a class="primary button" id="goRegular">
        Go full-screen<br>
        <small>hit ESC to exit.</small>
      </a>

      <p id="nightly">Use with <a href="http://mozvr.com/downloads/" target="_blank">Firefox Nightly</a> or
        <a href="http://blog.tojicode.com/2014/07/bringing-vr-to-chrome.html" target="_blank">Chrome WebVR</a>
        to view in virtual reality! Read more about WebVR at <a href="http://mozvr.com/" target="_blank">MozVR.com</a></p>

      <h2>Instructions:</h2>
      <ul>
        <li>Use the keyboard (<kbd>WASD</kbd>) to navigate.</li>
        <li>Use <kbd>SHIFT+mouse</kbd> to look around.</li>
        <li><em>Oculus Rift DK2 compatible!</em> Use WebVR-enabled browser (see above).</li>
        <li><em>Google Cardboard compatible!</em> Use PC for input and smartphone as HMD.</li>
      </ul>
    </article>

  </body>
</html>
