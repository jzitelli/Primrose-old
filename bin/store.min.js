function showSection(a,b){var c;if(a&&(c=document.getElementById(a),c||(c=document.getElementsByTagName("article")[0],a=c.id),c.className="selected",c.scrollTop=0),!isMobile||lastTab!==a){lastTab&&(c=document.getElementById(lastTab),c.className=""),lastTab=lastTab===a?null:a,tabs=document.querySelectorAll("#menu > a");var d=new RegExp(fmt("^javascript:showSection\\('($1)?'\\);$",lastTab));for(i=0;i<tabs.length;++i)t=tabs[i],d.test(t.href)?t.className="selected button":t.className="button";var e="#"+(lastTab||"");b||history.pushState(null,"Primrose"+(lastTab?" > "+lastTab:""),e),ga("send","pageview",e)}}function makeItemPurchase(a,b,c,d,e){function f(a,b,c,d){var e=document.getElementById(b.id+"-msg"),f=document.getElementById(b.id+"-ref"),g=document.getElementById(b.id+"-email");console.error(c,d||"",e,g,f),e.innerHTML=c,g.innerHTML="Sean T. McBeth &lt;sean@primroseeditor.com&gt;",g.href="mailto:sean@primroseeditor.com",d&&(f.innerHTML+=fmt("REF #: $1.",d),g.href+=fmt("?subject=Purchase Error REF #: $1",d)),h=!0,a.className="disabled button",b.style.display="block"}function g(b){if("ok"===b.status){var e=document.getElementById(c.id+"-token"),g=document.getElementById(c.id+"-license");e.innerHTML=b.id,g.innerHTML=b.license,c.style.display="block"}else f(a,d,fmt("The purchase process with Stripe failed. Reason: $1.",b.error),b.id)}var h=!1;if(prices&&void 0!==prices[e]){var i=fmt("$$1.00",prices.editor_license/100);b.innerHTML=i;var j=StripeCheckout.configure({key:prices.stripe_public_key,image:"images/logo128dark.png",name:"Primrose Editor",zipCode:!0,token:function(b){b.item=e,sendObject(document.location.protocol+"//"+document.location.hostname+":8082/purchase",b,f.bind(this,a,d,"We couldn't communicate with our own server.",b.id),g)}});window.addEventListener("popstate",j.close.bind(j)),a.addEventListener("click",function(){h||j.open({description:"Proprietary license ("+i+")",amount:prices[e]})})}else a.className="disabled button"}function initStore(){ctrls=findEverything();for(var a=document.getElementsByClassName("version-label"),b=0;b<a.length;++b)a[b].innerHTML=Primrose.VERSION;showSection(window.location.hash.length>1?window.location.hash.substring(1):"home"),getObject("data/config.json",function(a){prices=a,makeItemPurchase(ctrls.buyLicenseButton,ctrls.licensePrice,ctrls.purchaseSuccess,ctrls.purchaseError,"editor_license")})}window.fnames=["EMAIL","FNAME","LNAME"],window.ftypes=["email","text","text"];var ctrls,prices,lastTab;window.addEventListener("popstate",function(a){var b=window.location.hash;b.length>0&&(b=b.substring(1),showSection(b,!0))});